# **Tours for the Soul**

## **Описание проекта**

Данный проект реализует бронирование туров по России. Он включает в себя приветствие с пользователем, демонстрацию туров, загруженных в базу данных, отображение описания тура, форму для отправки заявки на бронирование и обратную связь пользователю.

## **Цели:**

- Проект разработан в целях оптимизации процесса бронирования туров.

## **Функциональность:**

Функциональность данного проекта заключается в отображении всех туров на одной странице в режиме "scroll" (прокрутка страницы с турами), в отображении описания тура на странице с турами (название, локация, длительность, цена и т.д.). При переходе на определенный тур добавляется развернутое описание тура и форма для отправки данных пользователя для броинрования, а именно:

- имя;
- электронный адрес;
- номер телефона;
- количество людей в группе.

Функционал формы заключается в отправке данных пользователя в базу данных и их сохранение. Перед отправкой форма проверяется на корректность введенных данных: проверка формата электронного почтового адреса, проверка формата номера телефона (должен начинаться с +7 и иметь вид +7ХХХХХХХХХХ, где Х-цифры), а так же проверка введенного количества людей в группе (людей должно быть больше 0, но не больше свободных мест в туре. Пользователь может выбрать как одного, так и нескольких людей).

После проверки формы на корректность, данные отправляются на сервер и обрабатываются для сохранения в базу данных, параллельно происходит обновление свободных мест в туре, путем вычитания забронированных мест из свободных, а так же отправка электронного письма польззователю с данными по туру и информацией по дальнейшим действиям.

Административная часть проекта включает в себя добавление в базу данных туров, с указанием необходимых данных, загрузкой изображения, удаление и редактирование сущесвтующих туров, а так же добаволение, редактирование и удаления пользователей.

В проекте использоуется логирование ошибок и событий для возможности контролировать работу приложения и возможные ошибки. 

## **Используемые инструменты:**

- **Flask** 3.1.0
- **Werkzeug** 3.1.3 (библиотека для создания WSGI-приложений, предоставляющая инструменты для работы с HTTP-запросами и ответами. Она является основой для Flask.)
- **Flask-Mail** 0.10.0 (расширение для Flask, которое упрощает отправку электронных писем из приложений Flask. Оно поддерживает различные почтовые сервисы и протоколы.)
- **SQLAlchemy** 2.0.3 (инструмент для работы с базами данных)
- **Python 3.12.7** 
- **Jinja2** 3.1.4 (шаблонизатор для Python, который позволяет создавать HTML и другие текстовые форматы с использованием шаблонов)
- **Pydantic** 2.10.2 (валидации данных и работа с типами данных)
- **Itsdangerous** 2.2.0 (библиотека для создания безопасных токенов и обработки данных, которые могут быть небезопасными. Используется в Flask для защиты данных, таких как сессии.)
- **Logging** (для логирования действий и ошибок)

## **Зависимости**

Для работы проекта требуется установить следующие зависимости:

- annotated-types==0.7.0
- blinker==1.9.0
- click==8.1.7
- colorama==0.4.6
- Flask==3.1.0
- Flask-Mail==0.10.0
- greenlet==3.1.1
- itsdangerous==2.2.0
- Jinja2==3.1.4
- MarkupSafe==3.0.2
- pydantic==2.10.2
- pydantic_core==2.27.1
- SQLAlchemy==2.0.36
- typing_extensions==4.12.2
- Werkzeug==3.1.3


## **Установка проекта и его запуск**

### 1. Клонируйте репозиторий

```bash
git clone https://github.com/Andrej10best/Flask_DIPLOMA.git
```

### 2. Создайте виртуальное окружение и активируйте его

```bash
python -m venv .venv
source .venv/bin/activate   # для Linux/MacOS
.\\.venv\Scripts\activate      # для Windows
```
### 3. Установите зависимости

```bash
pip install -r requirements.txt
```
###  4. Заготовленная база данных уже имеется, поэтому миграция не нужна

### 5. Перейдите в директорию проекта

```bash
cd .\app\
```

### 6. Запустите сервер

```bash
python run.py
```

Приложение доступно по адресу: http://127.0.0.1:5000/.

## Структура проекта

```
Flask_DIPLOMA
├── app                                             # Основная папка приложения
│   ├── __init__.py                                 # Инициализация пакета приложения
│   ├── config.py                                   # Конфигурация приложения (данные для админа: логин, пароль)
│   ├── database                                    # Папка для работы с базой данных
│   │   ├── __init__.py                             # Инициализация пакета базы данных
│   │   └── db.py                                   # Конфигурация подключения к базе данных и модели данных
│   ├── log_set                                     # Папка для настроек логирования
│   │   ├── __init__.py                             # Инициализация пакета для логирования
│   │   └── log_setting.py                          # Конфигурация логирования приложения
│   ├── routes                                      # Папка для маршрутов (routes) приложения
│   │   ├── __init__.py                             # Инициализация пакета маршрутов
│   │   ├── admin_routes.py                         # Маршруты для административной панели
│   │   └── routes.py                               # Общие маршруты для приложения
│   ├── run.py                                      # Главный файл для запуска приложения
│   ├── static                                      # Папка для статических файлов (CSS, изображения и т.д.)
│   │   ├── css                                     # Подкаталог для CSS файлов
│   │   │   ├── admin_add_tour_page_style.css       # Стиль для страницы добавления тура (админ)
│   │   │   ├── admin_clients_page_style.css        # Стиль для страницы клиентов (админ)
│   │   │   ├── admin_delete_tour_page_style.css    # Стиль для страницы удаления тура (админ)
│   │   │   ├── admin_delete_user_page_style.css    # Стиль для страницы удаления пользователя (админ)
│   │   │   ├── admin_edit_style.css                # Стиль для страницы редактирования (админ)
│   │   │   ├── admin_login_style.css               # Стиль для страницы логина (админ)
│   │   │   ├── admin_up_or_del_tour_page_style.css # Стиль для страницы обновления или удаления тура (админ)
│   │   │   ├── base_page_style.css                 # Основной стиль для страниц
│   │   │   ├── book_tour_page_style.css            # Стиль для страницы бронирования тура
│   │   │   ├── error_page_style.css                # Стиль для страницы ошибки
│   │   │   ├── list_tours_page_style.css           # Стиль для страницы списка туров
│   │   │   └── success_book_page_style.css         # Стиль для страницы успешного бронирования
│   │   ├── image                                   # Папка для изображений
│   │   │   └── img_tour                            # Подкаталог для изображений туров
│   │   │       ├── Грузия.jpg                      
│   │   │       ├── Камчатка.jpg  
│   │   │       ├── Карелия.jpg  
│   │   │       └── Северная_Осетия.jpg  
│   │   └── site_background                         # Папка для фоновых изображений сайта
│   │       └── back_img.jpg                        
│   └── templates                                   # Папка для HTML-шаблонов
│       ├── admin                                   # Папка для административных шаблонов
│       │   ├── admin_add_tour_page.html            # Шаблон для страницы добавления тура (админ)
│       │   ├── admin_clients_page.html             # Шаблон для страницы клиентов (админ)
│       │   ├── admin_delete_tour_page.html         # Шаблон для страницы удаления тура (админ)
│       │   ├── admin_delete_user_page.html         # Шаблон для страницы удаления пользователя (админ)
│       │   ├── admin_edit_list.html                # Шаблон для страницы редактирования списка (админ)
│       │   ├── admin_login.html                    # Шаблон для страницы логина (админ)
│       │   ├── admin_up_or_del_tour_page.html      # Шаблон для страницы обновления или удаления тура (админ)
│       │   └── admin_update_tour_page.html         # Шаблон для страницы обновления тура (админ)
│       └── user                                    # Папка для пользовательских шаблонов
│           ├── base_page.html                      # Основной шаблон страницы для пользователей
│           ├── book_tour_page.html                 # Шаблон для страницы бронирования тура
│           ├── empty_list_tours_page.html          # Шаблон для страницы с пустым списком туров
│           ├── empty_list_users_page.html          # Шаблон для страницы с пустым списком пользователей
│           ├── error_page.html                     # Шаблон для страницы с ошибкой
│           ├── list_tours_page.html                # Шаблон для страницы списка туров
│           └── success_book_page.html              # Шаблон для страницы успешного бронирования
├── data.db                                         # Файл базы данных
├── example_image                                   # Папка для тестовых загрузок изображений через админ панель
│   ├── Махачкала.jpg  
│   ├── Пятигорск.jpg  
│   └── Ушгули.jpg  
├── logs.log                                        # Файл для логирования событий приложения
└── requirements.txt                                # Файл с зависимостями проекта
```

## Использование админ-панели

- при переходе по адресу http://127.0.0.1:5000/admin открывается админ-панель, в которой необходимо ввести данные админа для взаимодействия с данными туров и пользователей.
- данные для входа уже сохранены в файле config.py (логин: admin, пароль: admin).
- после входа админ запишется в сессии и при переходе на другие страницы админ-панели, будет выполняться проверка, есть ли даннный пользовательь в сессии, после определенного времени сессия сбрасывается, нужно будет произвести вход повторно.

## Логирование

Логирование осуществляется с помощью модуля logging. Вся информация, а так же ошибки записываются в файл logs.log

## Прочее

- Если перед проверкой данного проекта открывались другие проекты, рекомендуется очистить файлы, сохраненные в кеше браузера, а затем переходить по локальному адресу http://127.0.0.1:8000 (без очистки кеша возможны неправильные отображения CSS стилей).
- Так же для удобства просмотров логов в IDE рекомендуется установить кодировку windows-1251 в файлах формата .log, для корректного отображения русских символов.

## Контакты

Вы можете связаться со мной по электронной почте:
Ваш Andrej10best@yandex.ru